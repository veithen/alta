<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2016-09-25 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160925" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Alta Maven Plugin - Configuring endorsed libraries in unit tests</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.4.min.js"></script>

                          
        
<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
              
              ga('create', 'UA-56790914-1', 'auto');
              ga('send', 'pageview');</script>
          
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="https://github.com/veithen/alta">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Alta Maven Plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2016-09-25
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.4.2
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                              
      <li>
  
                          <a href="../index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                                                                                                                  
      <li>
  
                          <a href="../plugin-info.html" title="Goals">
          <span class="icon-chevron-down"></span>
        Goals</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="../generate-files-mojo.html" title="generate-files">
          <span class="none"></span>
        generate-files</a>
            </li>
                    
      <li>
  
                          <a href="../generate-properties-mojo.html" title="generate-properties">
          <span class="none"></span>
        generate-properties</a>
            </li>
                    
      <li>
  
                          <a href="../generate-resources-mojo.html" title="generate-resources">
          <span class="none"></span>
        generate-resources</a>
            </li>
                    
      <li>
  
                          <a href="../generate-test-resources-mojo.html" title="generate-test-resources">
          <span class="none"></span>
        generate-test-resources</a>
            </li>
              </ul>
        </li>
                
      <li>
  
                          <a href="../properties.html" title="Supported properties">
          <span class="none"></span>
        Supported properties</a>
            </li>
                
      <li>
  
                          <a href="../artifact-sets.html" title="Artifact set configuration">
          <span class="none"></span>
        Artifact set configuration</a>
            </li>
                              <li class="nav-header">Examples</li>
                              
      <li class="active">
  
            <a href="#"><span class="none"></span>Configuring endorsed libraries in unit tests</a>
          </li>
                
      <li>
  
                          <a href="../examples/pax-exam.html" title="Using Pax Exam in Maven builds">
          <span class="none"></span>
        Using Pax Exam in Maven builds</a>
            </li>
                
      <li>
  
                          <a href="../examples/pax-exam-single-module.html" title="Single module Pax Exam configuration">
          <span class="none"></span>
        Single module Pax Exam configuration</a>
            </li>
                
      <li>
  
                          <a href="../examples/agent.html" title="Configuring Surefire Plugin with AspectJ load-time weaving">
          <span class="none"></span>
        Configuring Surefire Plugin with AspectJ load-time weaving</a>
            </li>
                              <li class="nav-header">Project Information</li>
                              
      <li>
  
                          <a href="../source-repository.html" title="Source Repository">
          <span class="none"></span>
        Source Repository</a>
            </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <!-- ~ --><!-- #%L --><!-- Alta Maven Plugin --><!-- %% --><!-- Copyright (C) 2014 - 2016 Andreas Veithen --><!-- %% --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!-- #L% --><!-- ~ --><div class="section">
<h2>Configuring endorsed libraries in unit tests<a name="Configuring_endorsed_libraries_in_unit_tests"></a></h2>
<p>In some cases, you need to run your unit tests with certain APIs at a different version level than what is provided by the JRE, either because you want to ensure that your code is compatible with older versions of these APIs or because the versions of the APIs included in the JRE are not the most recent ones, but your code expects the latest versions.</p>
<p>In a Maven build this is typically achieved by using <a class="externalLink" href="http://maven.apache.org/plugins/maven-dependency-plugin/">maven-dependency-plugin</a> to copy these libraries to a folder under <tt>target/</tt> and configuring <a class="externalLink" href="http://maven.apache.org/surefire/maven-surefire-plugin/">maven-surefire-plugin</a> to add <tt>-Djava.endorsed.dirs=...</tt> (with the directory containing the JARs) or <tt>-Xbootclasspath/p:...</tt> (with the list of individual JARs) to the command line of the JVM that executes the tests.</p>
<p>Copying the JARs to the project build directory is an extra step that should not be necessary, considering that the JARs are already in the local Maven repository. To avoid this extra step, one needs to compute the paths to the artifacts in the local repository and pass the list of these paths to the <tt>-Xbootclasspath/p:...</tt> JVM argument.</p>
<p>This can easily be achieved with the help of the <a href="../generate-properties-mojo.html">alta:generate-properties</a> goal:</p>
<div class="source"><pre class="prettyprint">&lt;plugins&gt;
    &lt;plugin&gt;
        &lt;groupId&gt;com.github.veithen.alta&lt;/groupId&gt;
        &lt;artifactId&gt;alta-maven-plugin&lt;/artifactId&gt;
        &lt;executions&gt;
            &lt;execution&gt;
                &lt;goals&gt;
                    &lt;goal&gt;generate-properties&lt;/goal&gt;
                &lt;/goals&gt;
                &lt;configuration&gt;
                    &lt;name&gt;surefire.bootclasspath&lt;/name&gt;
                    &lt;value&gt;%file%&lt;/value&gt;
                    &lt;separator&gt;${path.separator}&lt;/separator&gt;
                    &lt;artifacts&gt;
                        &lt;artifact&gt;
                            &lt;groupId&gt;xerces&lt;/groupId&gt;
                            &lt;artifactId&gt;xmlParserAPIs&lt;/artifactId&gt;
                            &lt;version&gt;2.6.2&lt;/version&gt;
                        &lt;/artifact&gt;
                        &lt;artifact&gt;
                            &lt;groupId&gt;org.apache.axis&lt;/groupId&gt;
                            &lt;artifactId&gt;axis-saaj&lt;/artifactId&gt;
                            &lt;version&gt;1.4&lt;/version&gt;
                        &lt;/artifact&gt;
                    &lt;/artifacts&gt;
                &lt;/configuration&gt;
            &lt;/execution&gt;
        &lt;/executions&gt;
    &lt;/plugin&gt;
    &lt;plugin&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
            &lt;argLine&gt;-Xbootclasspath/p:${surefire.bootclasspath}&lt;/argLine&gt;
        &lt;/configuration&gt;
    &lt;/plugin&gt;
&lt;/plugins&gt;
</pre></div>
<p><b>Note:</b> This configuration uses <tt>surefire.bootclasspath</tt> as property name. You should avoid using <tt>bootclasspath</tt> here because that property is used as a default value for the <a class="externalLink" href="https://maven.apache.org/plugins/maven-javadoc-plugin/jar-mojo.html#bootclasspath"><tt>bootclasspath</tt></a> parameter by <tt>maven-javadoc-plugin</tt>.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2014&#x2013;2016.
          All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
