<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M19 from src/site/markdown/examples/bootclasspath.md at 2024-09-15
 | Rendered using Apache Maven Fluido Skin 2.0.0-M10
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M19" />
    <title>Configuring endorsed libraries in unit tests (Java &lt;= 8) – Alta Maven Plugin</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-2.0.0-M10.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
    <script src="../js/apache-maven-fluido-2.0.0-M10.min.js"></script>
<script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
              
              ga('create', 'UA-56790914-1', 'auto');
              ga('send', 'pageview');
            </script>
    <style>.github-fork-ribbon:before { background-color: gray; }</style>
  </head>
  <body>
    <a class="github-fork-ribbon right-top" href="https://github.com/veithen/alta" data-ribbon="Fork me on GitHub">Fork me on GitHub</a>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>Alta Maven Plugin</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-09-15<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 0.8.1</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="../index.html">Introduction</a></li>
    <li><a href="../plugin-info.html"><span class="icon-chevron-down"></span>Goals</a>
     <ul class="nav nav-list">
      <li><a href="../copy-mojo.html">copy</a></li>
      <li><a href="../generate-files-mojo.html">generate-files</a></li>
      <li><a href="../generate-properties-mojo.html">generate-properties</a></li>
      <li><a href="../generate-resources-mojo.html">generate-resources</a></li>
      <li><a href="../generate-test-resources-mojo.html">generate-test-resources</a></li>
     </ul></li>
    <li><a href="../properties.html">Supported properties</a></li>
    <li><a href="../artifact-sets.html">Artifact set configuration</a></li>
   <li class="nav-header">Examples</li>
    <li class="active"><a>Configuring endorsed libraries in unit tests</a></li>
    <li><a href="../examples/pax-exam.html">Using Pax Exam in Maven builds</a></li>
    <li><a href="../examples/pax-exam-single-module.html">Single module Pax Exam configuration</a></li>
    <li><a href="../examples/agent.html">Configuring Surefire Plugin with AspectJ load-time weaving</a></li>
   <li class="nav-header">Project Information</li>
    <li><a href="../scm.html">Source Repository</a></li>
    <li><a href="https://app.codecov.io/gh/veithen/alta" class="externalLink">Code Coverage</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="https://maven.apache.org/" class="builtBy" target="_blank"><img class="builtBy" alt="Built by Maven" src="../images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<!--
  #%L
  Alta Maven Plugin
  %%
  Copyright (C) 2014 - 2024 Andreas Veithen
  %%
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  #L%
  -->
<section><a id="Configuring_endorsed_libraries_in_unit_tests_.28Java_.3C.3D_8.29"></a>
<h1>Configuring endorsed libraries in unit tests (Java &lt;= 8)</h1>
<p>In some cases, you need to run your unit tests with certain APIs at a different
version level than what is provided by the JRE, either because you want to ensure
that your code is compatible with older versions of these APIs or because
the versions of the APIs included in the JRE are not the most recent ones, but
your code expects the latest versions.</p>
<p>In a Maven build this is typically achieved by using
<a href="http://maven.apache.org/plugins/maven-dependency-plugin/" class="externalLink">maven-dependency-plugin</a> to
copy these libraries to a folder under <code>target/</code> and configuring
<a href="http://maven.apache.org/surefire/maven-surefire-plugin/" class="externalLink">maven-surefire-plugin</a>
to add <code>-Djava.endorsed.dirs=...</code> (with the directory containing the JARs) or
<code>-Xbootclasspath/p:...</code> (with the list of individual JARs) to the command line
of the JVM that executes the tests.</p>
<p>Copying the JARs to the project build directory is an extra step that should not be
necessary, considering that the JARs are already in the local Maven repository.
To avoid this extra step, one needs to compute the paths to the artifacts in the
local repository and pass the list of these paths to the <code>-Xbootclasspath/p:...</code>
JVM argument.</p>
<p>This can easily be achieved with the help of the
<a href="../generate-properties-mojo.html">alta:generate-properties</a> goal:</p>
<pre class="prettyprint"><code>&lt;plugin&gt;
    &lt;groupId&gt;com.github.veithen.alta&lt;/groupId&gt;
    &lt;artifactId&gt;alta-maven-plugin&lt;/artifactId&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;goals&gt;
                &lt;goal&gt;generate-properties&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
                &lt;name&gt;surefire.bootclasspath&lt;/name&gt;
                &lt;value&gt;%file%&lt;/value&gt;
                &lt;separator&gt;${path.separator}&lt;/separator&gt;
                &lt;artifactSet&gt;
                    &lt;artifacts&gt;
                        &lt;artifact&gt;
                            &lt;groupId&gt;xerces&lt;/groupId&gt;
                            &lt;artifactId&gt;xmlParserAPIs&lt;/artifactId&gt;
                            &lt;version&gt;2.6.2&lt;/version&gt;
                        &lt;/artifact&gt;
                        &lt;artifact&gt;
                            &lt;groupId&gt;org.apache.axis&lt;/groupId&gt;
                            &lt;artifactId&gt;axis-saaj&lt;/artifactId&gt;
                            &lt;version&gt;1.4&lt;/version&gt;
                        &lt;/artifact&gt;
                    &lt;/artifacts&gt;
                &lt;/artifactSet&gt;
            &lt;/configuration&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;
&lt;plugin&gt;
    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
        &lt;argLine&gt;-Xbootclasspath/p:${surefire.bootclasspath}&lt;/argLine&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre>

<p><strong>Note:</strong> This configuration uses <code>surefire.bootclasspath</code> as property name. You should
avoid using <code>bootclasspath</code> here because that property is used as a default value
for the <a href="https://maven.apache.org/plugins/maven-javadoc-plugin/jar-mojo.html#bootclasspath" class="externalLink"><code>bootclasspath</code></a>
parameter by <code>maven-javadoc-plugin</code>.</p></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>©      2014–2024
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
